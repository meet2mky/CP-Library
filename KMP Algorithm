#include<iostream>
#include<string>
#include<vector>
#include<algorithm>
using namespace std;
vector<int> prefix_fun(string const& s) {
	int n = (int)s.size();
	vector<int> pi(n);
	pi[0] = 0;
	for (int i = 1; i < n; i++) {
		int j = pi[i - 1];
		while (j > 0 && s[j] != s[i]) {
			j = pi[j - 1];
		}
		if (s[j] == s[i]) {
			j++;
		}
		pi[i] = j;
	}
	return pi;
}
void kmp(string const& pat, string const& text) {
	int n = (int)pat.size();
	string tmp = pat;
	tmp += '#';
	tmp += text;
	vector<int> pf = prefix_fun(tmp);
	for (int i = 0; i < (int)pf.size(); i++) {
		if (pf[i] == n) {
			cout << "Matched at position: " << i - (n + 1) - n + 1 << endl;
		}
	}

}
int main() {
	cout << "Enter string: ";
	string pat, text;
	getline(cin, pat);
	cout << "Enter text: ";
	getline(cin, text);
	kmp(pat,text);
	return 0;
}
